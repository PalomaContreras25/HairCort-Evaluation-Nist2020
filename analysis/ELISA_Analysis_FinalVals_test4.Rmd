---
title: "Analysis of final values - test4"
author: "Paloma"
date: "`r Sys.Date()`"
output: workflowr::wflow_html
---
# Introduction

Here I plan to include measurements and visualizations of the accuracy, precision, and linearity of ELISA #4. I will do this using two different ways of calculating final values: the standard method not accounting for spike, and an alternative method accounting for it. The way the spike is included in the formula is defined in file ELISA_Calc_FinalVals_test4.html.

*Plate description*

Category	  Description
---------  ---------------------------------------------------------------
TA        	Non-spiked serial dilution
TB         	Spiked only in first dilution (TB1) then serially diluted
TC        	Each dilution individually spiked with 25 µL of std1
TD          First tube spiked 1:1 with std1 (110 µL), then serially diluted
TP        	Precision replicates (different weights: 6, 9, 12 mg) spiked with 25 µL

```{r echo=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

```{r libraries, echo = FALSE, warning = FALSE, message=FALSE}
# Install libraries

library(knitr)
library(RColorBrewer)
library(stats)
library(coefplot)
library(arm)
library(bbmle)
library(plyr)
library(ggpmisc)
library(ggplot2)
library(dplyr)
library(tidyverse)
```

```{r loading}
# Loading data
std <- read.csv("./data/Test4/standard_data_test4.csv")
cort_vals<- read.csv("./data/Test4/Data_cort_values_method_ALL.csv")
```

# Overall Results
## A) Standard method

```{r loading valsA}
# remove NSB
data <- cort_vals[!(cort_vals$Sample == c("B0", "BE", "NSB", "POOL")),]
```

```{r expABC.Final_pg.mg_A, fig.width=8, fig.height=6}
# Scatter plot of Experiment A and B, observed binding % 
a <- filter(data, Category == "A" | Category =="Standard" | Category == "B" | Category == "C" | Category == "D", !is.na(Final_pg.mg_A)) 
a$Sample_num <- 1:length(a$Sample)
a$Failed_samples[is.na(a$Failed_samples)] <- "OK"
cat(paste("Data has", nrow(a), "data points", sep= " "))


## PLOT WITHOUT POOR QUALITY SAMPLES ### 
exp <- a %>%
  filter(!Sample %in% c("TA6","TA7","TB7","TC7", "TC6","TC5", "A2"))

ggplot(exp, aes(x = Sample_num, 
                 y = Final_pg.mg_A, color = Category)) +
  geom_smooth(method = "lm", se = TRUE, linewidth = 0.4, alpha = 0.2, aes(group = exp$Category)) +
  geom_smooth(formula = y ~ log(x), se = FALSE, linewidth = 0.2, linetype = 2) +
  geom_point(size = 2) +
  geom_text(aes(label = Sample), size = 2.5, vjust = -1, hjust = 0.5, color = "gray30") +
  geom_hline(yintercept = 0, linetype = "dashed", 
                  color = "red", linewidth = 0.5) + 
# stat_poly_eq(aes(x = Sample_num, label = 
# paste(..rr.label.., sep = "~")),
#               formula = y ~ x, parse = TRUE, size = 2) +
  labs(title = "Final vals (A) not accounting for spike",
       subtitle = "removed high CV samples",
       x = "Sample", y = "Cortisol concentration pg/mg, Method A") +
  scale_y_continuous(n.breaks = 10) + 
  theme_minimal() 

```

## B) Accounting for spike (Nist et al. 2020)

```{r expABC.Final_pg.mg_B, fig.width=8, fig.height=6, }

## PLOT WITHOUT POOR QUALITY SAMPLES ### 

ggplot(exp, aes(x = Sample_num, 
                 y = Final_pg.mg_B, color = Category)) +
  geom_smooth(method = "lm", se = TRUE, linewidth = 0.4, alpha = 0.05) +
  geom_smooth(formula = y ~ log(x), se = FALSE, linewidth = 0.2, linetype = 2, alpha = 0.1) +
  geom_point(size = 2) +
  geom_text(aes(label = Sample), size = 2.5, vjust = -1, hjust = 0.5, color = "gray30") +
  geom_hline(yintercept = 0, linetype = "dashed", 
                  color = "red", linewidth = 0.5) + 
 # stat_poly_eq(aes(x = Sample_num, label = paste(..rr.label.., sep = "~")),
 #              formula = y ~ x, parse = TRUE, size = 2) +
  labs(title = "Final vals (B) accounting for spike",
       subtitle = "removed high CV samples",
       x = "Sample", y = "Cortisol concentration pg/mg, Method B") +
  scale_y_continuous(n.breaks = 10)  +
  theme_minimal()

```

## C) Sam's Method
```{r expABC.Final_pg.mg_C, fig.width=8, fig.height=6}

## PLOT WITHOUT POOR QUALITY SAMPLES ### 

ggplot(exp, aes(x = Sample_num, 
                 y = Final_pg.mg_C, color = Category)) +
  geom_smooth(method = "lm", se = TRUE, linewidth = 0.4, alpha = 0.05) +
  geom_smooth(formula = y ~ log(x), se = FALSE, linewidth = 0.3, linetype = 2, alpha = 0.1) +
  geom_point(size = 2) +
  geom_text(aes(label = Sample), size = 2.5, vjust = -1, hjust = 0.5, color = "gray30") +
  geom_hline(yintercept = 0, linetype = "dashed", 
                  color = "red", linewidth = 0.5) + 
  labs(title = "Final values, method C",
       subtitle = "Removed low quality samples",
       x = "Sample", y = "Cortisol concentration pg/mg, Method C") +
  scale_y_continuous(n.breaks = 10) + 
  theme_minimal() 

```


# Comparing all calculation methods
## Summary
```{r 4-results-boxplot, echo = FALSE}
# Save result
cat("Results:")
tail(data[,c("Sample", "Final_pg.mg_A", "Final_pg.mg_B", "Final_pg.mg_C")])
data4<-data

# View summary
cat("Summary of final values for each calculation method")
cat("Method A:")
summary(data$Final_pg.mg_A)
cat("Method B:")
summary(data$Final_pg.mg_B)
cat("Method C:")
summary(data$Final_pg.mg_C)

# Reshape from wide to long format
data_long <- data %>%
  select(Final_pg.mg_A, Final_pg.mg_B, Final_pg.mg_C) %>%
  pivot_longer(
    cols = everything(),
    names_to = "Method",
    values_to = "pg_mg"
  )

# Optional: clean group names for prettier x-axis labels
data_long$Group <- gsub("Final_pg.mg_", "", data_long$Method)

# Plot boxplots
ggplot(data_long, aes(x = Group, y = pg_mg, fill = Method)) +
  geom_boxplot(outlier.shape = 21, outlier.fill = "white", outlier.color = "black") +
  labs(
    title = "Test4: Final values using calculation methods A, B, and C",
    x = "Method",
    y = "pg/mg"
  ) +
  theme_minimal() +
  theme(legend.position = "none")

```

```{r 4-results-scatterplot, echo = FALSE}

# Reshape data for plotting
data_long <- data %>%
  pivot_longer(
    cols = c(Final_pg.mg_A, Final_pg.mg_B, Final_pg.mg_C),
    names_to = "Method",
    values_to = "Final_pg.mg"
  )

ggplot(data_long, aes(x = Sample, y = Final_pg.mg, color = Method, group = Method)) +
  geom_line(aes(group = Sample), color = "gray75", size = 0.5) +
  geom_point(size = 2.8, alpha = 0.7, position = position_dodge(width=0.5)) +
  scale_color_manual(
    values = c("Final_pg.mg_A" = "steelblue",
               "Final_pg.mg_B" = "orange",
               "Final_pg.mg_C" = "darkgreen"),
    labels = c("Method A (Traditional)",
               "Method B (Nist et al.)",
               "Method C (Sam's)")
  ) +
  labs(
    title = "Hair Cortisol by Sample and Calculation Method",
    x = "Sample ID",
    y = "Final Cortisol (pg/mg)",
    color = "Method"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 90, hjust = 1),
    legend.position = "top"
  )


```


```{r 4-results-A and C, echo =FALSE}

# Reshape to long format
data_long <- data %>%
  pivot_longer(
    cols = c(Final_pg.mg_A, Final_pg.mg_C),
    names_to = "Method",
    values_to = "Final_pg.mg"
  )

# Plot with lines connecting A and C values for each sample
ggplot(data_long, aes(x = Sample, y = Final_pg.mg, color = Method, group = Method)) +
  geom_line(aes(group = Sample), linewidth = 0.6, color = "gray70") +  # light line connecting methods
  geom_point(size = 2.8, alpha = 0.8, position = position_dodge(width = 0.5)) +
  scale_color_manual(
    values = c("Final_pg.mg_A" = "steelblue", "Final_pg.mg_C" = "darkgreen"),
    labels = c("Method A", "Method C")
  ) +
  labs(
    title = "Comparing final values obtained using 2 methods, by Sample",
    x = "Sample ID",
    y = "Final Cortisol Concentration (pg/mg)",
    color = "Calculation Method"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
    legend.position = "top"
  )

```


```{r}
# Filter to include only good quality samples
data_ok <- data %>%
    filter(!is.na(Binding.Perc)) %>%
  filter(Failed_samples == "OK")

# Reshape data for plotting
data_long_ok <- data_ok %>%
  pivot_longer(
    cols = c(Final_pg.mg_A, Final_pg.mg_C),
    names_to = "Method",
    values_to = "Final_pg.mg"
  )

head(data_long_ok)
# Plot for OK samples only
ggplot(data_long_ok, aes(x = Sample, y = Final_pg.mg, color = Method)) +
  geom_line(aes(group = Sample), color = "gray75", size = 0.5) +
  geom_point(size = 3, alpha = 0.8, position = position_dodge(width = 0.5)) +
  scale_color_manual(
    values = c("Final_pg.mg_A" = "steelblue",
               "Final_pg.mg_B" = "orange",
               "Final_pg.mg_C" = "darkgreen"),
    labels = c("Method A (Basic)",
               "Method B (Subtraction + x2)",
               "Method D (Spike contribution)")
  ) +
  labs(
    title = "Hair Cortisol (Good Samples Only) — Test4",
    x = "Sample ID",
    y = "Final Cortisol (pg/mg)",
    color = "Method"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 90, hjust = 1),
    legend.position = "top"
  )
summary(data_ok$Final_pg.mg_C)
```


# Accuracy

Accuracy, or recovery %, is the ratio between observed and expected concentration, multiplied by 100. 
Expected values are defined using the dilution factor, starting with the concentrastion value of the neat sample. 

- 80–120% is generally acceptable for biological assays.

- 70–130% may be acceptable at very low concentrations.

```{r calc-expected, echo = FALSE, include = FALSE}
# Expected values, using different calculation methods
a$Expected_A <- NA
a$Expected_A[1:7] <- 31.19595 / a$Dilution_sample[1:7] 
a$Expected_A[8:14] <-  34.2266667/ a$Dilution_sample[1:7] 
a$Expected_A[15:21] <-  18.27407  / a$Dilution_sample[1:7] 
a$Expected_A[22:28] <-  30.5653333 / a$Dilution_sample[1:7]

a$Expected_B <- NA
a$Expected_B[1:7] <- 31.1959459 / a$Dilution_sample[1:7] 
a$Expected_B[8:14] <-  25.6600000/ a$Dilution_sample[1:7] 
a$Expected_B[15:21] <-   -11.0000000  / a$Dilution_sample[1:7] 
a$Expected_B[22:28] <-  14.0580000 / a$Dilution_sample[1:7]

a$Expected_C <- NA
a$Expected_C[1:7] <- 30.7800000 / a$Dilution_sample[1:7] 
a$Expected_C[8:14] <-  32.2815152 / a$Dilution_sample[1:7] 
a$Expected_C[15:21] <-  14.5015152  / a$Dilution_sample[1:7] 
a$Expected_C[22:28] <-  18.7971667 / a$Dilution_sample[1:7]

```


```{r expABCD.conc.expect.vs.observed, results = 'hide', include = FALSE}

ggplot(a, aes(x = Expected_A, 
                 y = (Final_pg.mg_A), color = Category)) +
  geom_smooth(method = "lm", se = TRUE, 
              linewidth = 0.5, 
              alpha = 0.1, linetype = 5) +
  geom_text(aes(label = Sample), size = 3, 
            vjust = -1, hjust = 0.5, 
            color = "gray70") +
 geom_abline(slope = 1, intercept = 0, 
             linetype = "dashed", color = "gold") +
  geom_point(size = 2) +
  stat_poly_eq(aes(x = a$Expected_A, 
                   label = paste(..rr.label.., sep = "~~~")),
               formula = y ~ x, parse = TRUE, size = 3) +
  labs(title = "Expected vs observed cortisol concentrations (not accounting for spike)",
       subtitle = "Complete dataset, final vals, method A",
       x = "Expected vals (pg/mL)", 
       y = "Observed vals (pg/mL)") +
  theme_bw() + 
  facet_wrap(~ Category)

```

```{r expABCD.conc.expect.vs.observedA-filt, include = FALSE}
print(a)
exp <- a %>%
  filter(!Sample %in% c("TA6","TA7","TB7","TC7", "TC6","TC5", "A2"))

ggplot(exp, aes(x = Expected_A, 
                y = Final_pg.mg_A, 
                color = Category)) +
  geom_smooth(method = "lm", se = TRUE, 
              linewidth = 0.4, alpha = 0.1, linetype = 5) +
  geom_point(size = 2) +
  geom_text(aes(label = Sample), size = 3, 
            vjust = -1, hjust = 0.5, color = "gray50") +
    geom_abline(slope = 1, intercept = 0, 
               linetype = "dashed", color = "gray") +
  labs(title = "Expected vs observed cortisol concentrations (not accounting for spike)",
       subtitle = "Removed low quality samples, final vals, methodA",
       x = "Expected vals (pg/mL)", 
       y = "Observed vals (pg/mL)") +
  theme_bw() + 
  facet_wrap(~ Category)
``` 




```{r expABCD.conc.expect.vs.observedB-filt, fig.width=8, fig.height=6, include = FALSE}

# Scatter plot of Experiment A and B, observed binding % 
## PLOT ## 

ggplot(exp, aes(x = Expected_B, 
                 y = Final_pg.mg_B, 
                color = Category)) +
  geom_smooth(method = "lm", se = TRUE, 
              linewidth = 0.4, alpha = 0.1, linetype = 5) +
  geom_point(size = 2) +
  geom_text(aes(label = Sample), size = 3, 
            vjust = -1, hjust = 0.5, color = "gray50") +
  stat_poly_eq(aes(x = Expected_B, 
                   label = paste(..rr.label.., sep = "~~~")),
               formula = y ~ x, parse = TRUE, size = 4) +
   geom_abline(slope = 1, intercept = 0, 
               linetype = "dashed", color = "gray") +
  labs(title = "Expected vs observed cortisol concentrations (not accounting for spike)",
       subtitle = "Removed low quality samples, final vals, methodB",
       x = "Expected vals (pg/mL)", y = "Observed vals (pg/mL)") +
  theme_bw() + 
  facet_wrap(~ Category)


```



```{r expABCD.conc.expect.vs.observed_D-filt, include = FALSE}
ggplot(exp, aes(x = Expected_C, 
                 y = Final_pg.mg_C, color = Category)) +
  geom_smooth(method = "lm", se = TRUE, linewidth = 0.3, alpha = 0.1) +
 geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "gold") +
  geom_point(size = 2) +
    geom_hline(yintercept = 0, linetype = "dashed", 
                  color = "red", linewidth = 0.5) + 
  geom_text(aes(label = Sample), size = 2, vjust = -1, hjust = 0.5, color = "gray50") +
  stat_poly_eq(aes(x = Expected_C, label = paste(..rr.label.., sep = "~~~")),
               formula = y ~ x, parse = TRUE, size = 4) +
  labs(title = "All serial dilutions: expected vs observed cortisol concentrations",
       subtitle = "Removed low quality samples, final vals, method C",
       x = "Expected vals (pg/mL)", y = "Observed vals (pg/mL)") +
  theme_bw() + 
  facet_wrap(~ Category)

``` 

# Precision

## Method A (controlling for dilution and weight)
```{r expE-concvals-final-vals-A}

# Scatter plot of Experiment a, observed binding % 
data <- cort_vals[!(cort_vals$Sample == "NSB"),]
a <- filter(data, Category == "P", !is.na(Final_pg.mg_A)) 
a$Sample_num <- 1:length(a$Sample)

exp <- a %>%
  mutate(Group = substr(Sample, 1, 3))

cv_values <- exp %>% 
  group_by(Group) %>%
  dplyr::summarise(
    cv_cort = round((sd(Final_pg.mg_A) / mean( Final_pg.mg_A)) * 100, 1), 
    mean_cort = round( mean( Final_pg.mg_A, na.rm = TRUE), 1),
    sd_cort = round(sd( Final_pg.mg_A, na.rm = TRUE), 1)
  )
cat("Variation in final cortisol values")
tail(cv_values)

# overall stats
all <- exp %>%
  summarise(
    Mean_cort = round(mean( Final_pg.mg_A, na.rm = TRUE),1),
    SD_cort = round(sd( Final_pg.mg_A, na.rm = TRUE),1),
    CV_cort = round((SD_cort / Mean_cort) * 100, 1)
  )


ggplot(exp, aes(x = Weight_mg, 
                 y =  Final_pg.mg_A)) +
  geom_point(size = 3, color = "gray40", alpha = 1) +
  geom_pointrange(data = cv_values,
                  aes(x = c(6,9,12), y = mean_cort,
                     ymin = mean_cort - sd_cort, ymax = mean_cort + sd_cort),
                color = "orange", size = 0.5, alpha = 0.6) +
  geom_smooth(method = "lm", se = TRUE, linewidth = 0.5, alpha = 0.05, color = "lightblue") +
  geom_text(aes(label = Sample), size = 3, vjust = -1, hjust = -0.5, color = "gray30") +
   labs(title = "Experiment E: Final conc vals (methodA) by sample weight",
       subtitle = "Precision, 25uL spike, 25uL sample",
       x = "Sample weight (mg)", y = " Final_pg.mg_A") +
  scale_y_continuous(n.breaks = 10) +
  coord_cartesian(xlim = c(4,14)) +
  theme_minimal() +
  annotate("text", x = 5.5, y = 65, label = paste0("CV: ", cv_values$cv_cort[cv_values$Group == "TP1"], "%"), size = 4) +
  annotate("text", x = 8.5, y = 65, label = paste0("CV: ", cv_values$cv_cort[cv_values$Group == "TP2"], "%"), size = 4) +
  annotate("text", x = 11.5, y = 65, label = paste0("CV: ", cv_values$cv_cort[cv_values$Group == "TP3"], "%"), size = 4) +
  annotate("text", x = 5.5, y = 60, label = paste0("mean: ", round(cv_values$mean_cort[cv_values$Group == "TP1"],2)), size = 4) +
  annotate("text", x = 8.5, y = 60, label = paste0("mean: ", round(cv_values$mean_cort[cv_values$Group == "TP2"],2)), size = 4) +
  annotate("text", x = 11.5, y = 60, label = paste0("mean: ", round(cv_values$mean_cort[cv_values$Group == "TP3"],2)), size = 4) 

```

## Method B (controlling for dilution, weight and spike)
```{r expE-concvals-final-vals-B}

# Scatter plot of Experiment B, observed binding % 

exp <- filter(cort_vals, Category == "P", !is.na(Binding.Perc)) 
exp$Sample_num <- 1:length(exp$Sample)

exp <- exp %>%
  mutate(Group = substr(Sample, 1, 3))
cv_values <- exp %>%
  group_by(Group) %>%
  dplyr::summarise(
    CV_cort = round((sd( Final_pg.mg_B) / mean(Final_pg.mg_B)) * 100, 1), 
    mean_cort = mean( Final_pg.mg_B, na.rm = TRUE),
    sd_cort = sd( Final_pg.mg_B, na.rm = TRUE)
  )

# overall stats
all <- exp %>%
  summarise(
    Mean_cort = mean( Final_pg.mg_B, na.rm = TRUE),
    SD_cort = sd( Final_pg.mg_B, na.rm = TRUE),
    CV_cort = (SD_cort / Mean_cort) * 100
  )


ggplot(exp, aes(x = Weight_mg, 
                 y =  Final_pg.mg_B)) +
geom_point(size = 3, color = "gray40", alpha = 1) +
  geom_pointrange(data = cv_values,
                  aes(x = c(6,9,12), y = mean_cort,
                      ymin = mean_cort - sd_cort, ymax = mean_cort + sd_cort),
                  color = "orange", size = 0.5, alpha = 0.6) +
  geom_smooth(method = "lm", se = TRUE, linewidth = 0.5, alpha = 0.05, color = "lightblue") +
  geom_text(aes(label = Sample), size = 3, vjust = -1, hjust = -0.5, color = "gray30") +
  geom_hline(yintercept = 0, linetype = "dashed", 
                  color = "red", linewidth = 0.8) +  
   labs(title = "Experiment E: Final conc vals (methodB) by sample weight",
       subtitle = "Precision, 25uL spike, 25uL sample",
       x = "Sample weight (mg)", y = " Final_pg.mg_B") +
  scale_y_continuous(n.breaks = 10) +
  coord_cartesian(xlim = c(4,14)) +
  theme_minimal() +
  annotate("text", x = 6, y = 35, label = paste0("CV: ", cv_values$CV_cort[cv_values$Group == "TP1"], "%"), size = 4) +
  annotate("text", x = 9, y = 35, label = paste0("CV: ", cv_values$CV_cort[cv_values$Group == "TP2"], "%"), size = 4) +
  annotate("text", x = 12, y = 35, label = paste0("CV: ", cv_values$CV_cort[cv_values$Group == "TP3"], "%"), size = 4) +
  annotate("text", x = 6, y = 40, label = paste0("mean: ", round(cv_values$mean_cort[cv_values$Group == "TP1"],2)), size = 4) +
  annotate("text", x = 9, y = 40, label = paste0("mean: ", round(cv_values$mean_cort[cv_values$Group == "TP2"],2)), size = 4) +
  annotate("text", x = 12, y = 40, label = paste0("mean: ", round(cv_values$mean_cort[cv_values$Group == "TP3"],2)), size = 4) 

print(cv_values)

```


## Method C (controlling for dilution and weight)
```{r expE-concvals-final-vals-c}

# Scatter plot of Experiment C, observed binding % 

exp <- filter( cort_vals, Category == "P", !is.na(Binding.Perc)) 
exp$Sample_num <- 1:length( exp$Sample )

exp <- exp %>%
  mutate(Group = substr(Sample, 1, 3))

cv_values <- exp %>% 
  group_by(Group) %>%
  dplyr::summarise(
    mean_cort = round( mean( Final_pg.mg_C, na.rm = TRUE), 1),
    sd_cort = round(sd( Final_pg.mg_C, na.rm = TRUE), 1),
    cv_cort = round((sd( Final_pg.mg_C ) / mean( Final_pg.mg_C)) * 100, 1), 
  )

# overall stats
all <- exp %>%
  summarise(
    Mean_cort = round(mean( Final_pg.mg_C, na.rm = TRUE),1),
    SD_cort = round(sd( Final_pg.mg_C, na.rm = TRUE),1),
    CV_cort = round((SD_cort / Mean_cort) * 100, 1)
  )


ggplot(exp, aes(x = Weight_mg, 
                 y =  Final_pg.mg_C)) +
geom_point(size = 3, color = "gray40", alpha = 1) +
  geom_pointrange(data = cv_values,
                 aes(x = c(6,9,12), y = mean_cort,
                     ymin = mean_cort - sd_cort, ymax = mean_cort + sd_cort),
                 color = "orange", size = 0.5, alpha = 0.8) +
  geom_smooth(method = "lm", se = TRUE, linewidth = 0.5, alpha = 0.05, color = "lightblue") +
  geom_text(aes(label = Sample), size = 3, vjust = -1, hjust = -0.5, color = "gray30") +
   labs(title = "Experiment E: Final conc vals (methodD) by sample weight",
       subtitle = "Precision, 25uL spike, 25uL sample",
       x = "Sample weight (mg)", y = " Final_pg.mg_C") +
  scale_y_continuous(n.breaks = 10) +
  coord_cartesian(xlim = c(4,14)) +
  theme_minimal() +
  annotate("text", x = 6, y = 38, label = paste0("CV: ", cv_values$cv_cort[cv_values$Group == "TP1"], "%"), size = 4) +
  annotate("text", x = 9, y = 38, label = paste0("CV: ", cv_values$cv_cort[cv_values$Group == "TP2"], "%"), size = 4) +
  annotate("text", x = 12, y = 38, label = paste0("CV: ", cv_values$cv_cort[cv_values$Group == "TP3"], "%"), size = 4) +
  annotate("text", x = 6, y = 40, label = paste0("mean: ", round(cv_values$mean_cort[cv_values$Group == "TP1"],2)), size = 4) +
  annotate("text", x = 9, y = 40, label = paste0("mean: ", round(cv_values$mean_cort[cv_values$Group == "TP2"],2)), size = 4) +
  annotate("text", x = 12, y = 40, label = paste0("mean: ", round(cv_values$mean_cort[cv_values$Group == "TP3"],2)), size = 4) 

print(cv_values)

```
